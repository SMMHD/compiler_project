╔══════════════════════════════════════════════════════════════════════════════════════════════════╗
║                              تحلیل دستی Shift-Reduce Parse                                      ║
║                                   پروژه کامپایلر - گروه 15                                       ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════╝

════════════════════════════════════════════════════════════════════════════════════════════════════
 قوانین گرامر (Grammar Rules)
════════════════════════════════════════════════════════════════════════════════════════════════════

قانون  | قاعده تولید                                   | توضیح                         
─────────────────────────────────────────────────────────────────────────────────────
R1     | Instruction → Mnemonic Operand                | دستور با عملوند               
R2     | Instruction → Mnemonic                        | دستور بدون عملوند             
R3     | Mnemonic → CLFLUSH | CLFLUSHOPT               | دستورات Flush                 
R4     | Mnemonic → CLWB                               | دستور Write-Back              
R5     | Mnemonic → PREFETCHT0 | PREFETCHT1 | ...      | دستورات Prefetch              
R6     | Mnemonic → WBINVD | INVD                      | دستورات Invalidate            
R7     | Operand → MemoryAddress                       | عملوند حافظه                  
R8     | MemoryAddress → [ BaseExpr ]                  | آدرس حافظه                    
R9     | BaseExpr → Register Offset                    | رجیستر با offset              
R10    | BaseExpr → Register                           | رجیستر ساده                   
R11    | BaseExpr → Identifier                         | شناسه/لیبل                    
R12    | Offset → + NUMBER                             | offset مثبت                   
R13    | Offset → - NUMBER                             | offset منفی                   


════════════════════════════════════════════════════════════════════════════════════════════════════
 مثال 1: CLFLUSH [EAX] - دستور ساده
════════════════════════════════════════════════════════════════════════════════════════════════════

📋 دستور ورودی: CLFLUSH [EAX]

────────────────────────────────────────────────────────────────────────────────────────────────────
مرحله    | پشته (Stack)                   | ورودی باقی‌مانده          | عملیات          | قانون/توضیح         
────────────────────────────────────────────────────────────────────────────────────────────────────
1        | $                              | CLFLUSH [ EAX ] $         | Shift           | انتقال CLFLUSH      
2        | $ CLFLUSH                      | [ EAX ] $                 | Reduce          | R3: CLFLUSH → Mnem  
3        | $ Mnemonic                     | [ EAX ] $                 | Shift           | انتقال [            
4        | $ Mnemonic [                   | EAX ] $                   | Shift           | انتقال رجیستر       
5        | $ Mnemonic [ EAX               | ] $                       | Reduce          | R10: REG → Base     
6        | $ Mnemonic [ Base              | ] $                       | Shift           | انتقال ]            
7        | $ Mnemonic [ Base ]            | $                         | Reduce          | R8: [Base] → MemAddr
8        | $ Mnemonic MemAddr             | $                         | Reduce          | R7: MemAddr → Operand
9        | $ Mnemonic Operand             | $                         | Reduce          | R1: Mnem+Op → Inst  
10       | $ Instruction                  | $                         | Accept          | ✅ پذیرش             
────────────────────────────────────────────────────────────────────────────────────────────────────
✅ پارس موفق - دستور معتبر است


════════════════════════════════════════════════════════════════════════════════════════════════════
 مثال 2: CLFLUSHOPT [EBX+16] - دستور با Offset مثبت
════════════════════════════════════════════════════════════════════════════════════════════════════

📋 دستور ورودی: CLFLUSHOPT [EBX+16]

────────────────────────────────────────────────────────────────────────────────────────────────────
مرحله    | پشته (Stack)                   | ورودی باقی‌مانده          | عملیات          | قانون/توضیح         
────────────────────────────────────────────────────────────────────────────────────────────────────
1        | $                              | CLFLUSHOPT [ EBX + 16 ] $ | Shift           | انتقال CLFLUSHOPT   
2        | $ CLFLUSHOPT                   | [ EBX + 16 ] $            | Reduce          | R3: CLFLUSHOPT → Mnem
3        | $ Mnemonic                     | [ EBX + 16 ] $            | Shift           | انتقال [            
4        | $ Mnemonic [                   | EBX + 16 ] $              | Shift           | انتقال رجیستر       
5        | $ Mnemonic [ EBX               | + 16 ] $                  | Shift           | انتقال +            
6        | $ Mnemonic [ EBX +             | 16 ] $                    | Shift           | انتقال عدد          
7        | $ Mnemonic [ EBX + 16          | ] $                       | Reduce          | R12: +NUM → Offset  
8        | $ Mnemonic [ EBX Offset        | ] $                       | Reduce          | R9: REG+Off → Base  
9        | $ Mnemonic [ Base              | ] $                       | Shift           | انتقال ]            
10       | $ Mnemonic [ Base ]            | $                         | Reduce          | R8: [Base] → MemAddr
11       | $ Mnemonic MemAddr             | $                         | Reduce          | R7: MemAddr → Operand
12       | $ Mnemonic Operand             | $                         | Reduce          | R1: Mnem+Op → Inst  
13       | $ Instruction                  | $                         | Accept          | ✅ پذیرش             
────────────────────────────────────────────────────────────────────────────────────────────────────
✅ پارس موفق - دستور معتبر است


════════════════════════════════════════════════════════════════════════════════════════════════════
 مثال 3: WBINVD - دستور بدون Operand
════════════════════════════════════════════════════════════════════════════════════════════════════

📋 دستور ورودی: WBINVD

────────────────────────────────────────────────────────────────────────────────────────────────────
مرحله    | پشته (Stack)                   | ورودی باقی‌مانده          | عملیات          | قانون/توضیح         
────────────────────────────────────────────────────────────────────────────────────────────────────
1        | $                              | WBINVD $                  | Shift           | انتقال WBINVD       
2        | $ WBINVD                       | $                         | Reduce          | R6: WBINVD → Mnem   
3        | $ Mnemonic                     | $                         | Reduce          | R2: Mnem → Inst     
4        | $ Instruction                  | $                         | Accept          | ✅ پذیرش             
────────────────────────────────────────────────────────────────────────────────────────────────────
✅ پارس موفق - دستور معتبر است


════════════════════════════════════════════════════════════════════════════════════════════════════
 مثال 4: CLWB [cache_line] - دستور با Label
════════════════════════════════════════════════════════════════════════════════════════════════════

📋 دستور ورودی: CLWB [cache_line]

────────────────────────────────────────────────────────────────────────────────────────────────────
مرحله    | پشته (Stack)                   | ورودی باقی‌مانده          | عملیات          | قانون/توضیح         
────────────────────────────────────────────────────────────────────────────────────────────────────
1        | $                              | CLWB [ cache_line ] $     | Shift           | انتقال CLWB         
2        | $ CLWB                         | [ cache_line ] $          | Reduce          | R4: CLWB → Mnem     
3        | $ Mnemonic                     | [ cache_line ] $          | Shift           | انتقال [            
4        | $ Mnemonic [                   | cache_line ] $            | Shift           | انتقال شناسه        
5        | $ Mnemonic [ cache_line        | ] $                       | Reduce          | R11: ID → Base      
6        | $ Mnemonic [ Base              | ] $                       | Shift           | انتقال ]            
7        | $ Mnemonic [ Base ]            | $                         | Reduce          | R8: [Base] → MemAddr
8        | $ Mnemonic MemAddr             | $                         | Reduce          | R7: MemAddr → Operand
9        | $ Mnemonic Operand             | $                         | Reduce          | R1: Mnem+Op → Inst  
10       | $ Instruction                  | $                         | Accept          | ✅ پذیرش             
────────────────────────────────────────────────────────────────────────────────────────────────────
✅ پارس موفق - دستور معتبر است


════════════════════════════════════════════════════════════════════════════════════════════════════
📝 نتیجه‌گیری
════════════════════════════════════════════════════════════════════════════════════════════════════

✅ تمامی دستورات با موفقیت پارس شدند
✅ گرامر بدون ابهام است
✅ Parser به صورت Bottom-Up (LR) کار می‌کند
✅ هر دستور دقیقاً یک درخت تجزیه دارد

این تحلیل نشان می‌دهد که:
1. گرامر طراحی شده قابل پارس با روش Shift-Reduce است
2. تمام حالات (با/بدون operand، با/بدون offset، رجیستر/شناسه) پشتیبانی می‌شوند
3. مراحل پارسینگ منطقی و قابل پیش‌بینی هستند

