; ══════════════════════════════════════════════════════════════════
; فایل تست ترکیبی - دستورات صحیح و نامعتبر
; ══════════════════════════════════════════════════════════════════
; این فایل برای تست error handling طراحی شده است
; ══════════════════════════════════════════════════════════════════

; ────────────────────────────────────────────────────────────────
; بخش 1: دستورات کاملاً صحیح
; ────────────────────────────────────────────────────────────────

CLFLUSH [EAX]                  ; دستور ساده - باید موفق باشد
CLFLUSHOPT [EBX+32]            ; با offset مثبت - باید موفق باشد
PREFETCHT0 [ECX-16]            ; با offset منفی - باید موفق باشد
WBINVD                         ; بدون operand - باید موفق باشد
CLWB [cache_buffer]            ; با label - باید موفق باشد

; ────────────────────────────────────────────────────────────────
; بخش 2: دستورات نامعتبر (تست error handling)
; ────────────────────────────────────────────────────────────────

INVALID [EAX]                  ; دستور وجود ندارد - باید خطا دهد
MOV EAX, EBX                   ; دستور معتبر اما خارج از scope - باید خطا دهد
CLFLUSH EAX                    ; بدون کروشه - باید خطا دهد
PREFETCH [ECX]                 ; نام اشتباه (باید PREFETCHT0 باشد) - باید خطا دهد

; ────────────────────────────────────────────────────────────────
; بخش 3: دستورات صحیح دوباره
; ────────────────────────────────────────────────────────────────

PREFETCHNTA [RAX+128]          ; رجیستر 64-bit - باید موفق باشد
CLFLUSH [R8]                   ; رجیستر مدرن - باید موفق باشد
INVD                           ; دستور invalidate - باید موفق باشد

; ────────────────────────────────────────────────────────────────
; بخش 4: موارد خاص و edge cases
; ────────────────────────────────────────────────────────────────

PREFETCHT1 [RDX+0]             ; offset صفر - باید موفق باشد
CLWB [my_var_123]              ; label با اعداد - باید موفق باشد
PREFETCHT2 [RBP-8]             ; Base Pointer - باید موفق باشد


; خط خالی بالا - باید نادیده گرفته شود

; ────────────────────────────────────────────────────────────────
; بخش 5: دستورات نامعتبر بیشتر
; ────────────────────────────────────────────────────────────────

ADD EAX, EBX                   ; دستور x86 عادی - باید خطا دهد
CLFLUSH [EAX] [EBX]            ; دو operand - باید خطا دهد
CLFLUSHOPT                     ; بدون operand برای دستوری که نیاز دارد - باید خطا دهد

; ────────────────────────────────────────────────────────────────
; بخش 6: دستورات نهایی صحیح
; ────────────────────────────────────────────────────────────────

CLFLUSH [R15D]                 ; آخرین رجیستر مدرن - باید موفق باشد
PREFETCHNTA [data_stream]      ; label معنادار - باید موفق باشد
CLWB [RSI+2048]                ; offset بزرگ - باید موفق باشد
WBINVD                         ; دستور آخر - باید موفق باشد

; ══════════════════════════════════════════════════════════════════
; پایان فایل
; انتظار: 15 دستور موفق، 6 خطا
; ══════════════════════════════════════════════════════════════════
