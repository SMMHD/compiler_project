#!/usr/bin/env python3
"""
Ø¬Ø¯ÙˆÙ„ Ù¾Ø§Ø±Ø³ Ú©Ø§Ù…Ù„ LR(0) Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªÙˆØ±Ø§Øª Ú©Ù†ØªØ±Ù„ Ú©Ø´
Complete LR(0) Parsing Table for Cache Control Instructions

Ù¾Ø±ÙˆÚ˜Ù‡ Ú©Ø§Ù…Ù¾Ø§ÛŒÙ„Ø± - Ú¯Ø±ÙˆÙ‡ 15
Ø¯Ø§Ù†Ø´Ú¯Ø§Ù‡ Ø´Ù‡ÛŒØ¯ Ø¨Ù‡Ø´ØªÛŒ
"""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ù‚ÙˆØ§Ù†ÛŒÙ† Ú¯Ø±Ø§Ù…Ø± (Grammar Rules)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GRAMMAR_RULES = {
    0:  "S' -> instruction",
    1:  "instruction -> mnemonic operand",
    2:  "instruction -> mnemonic",
    3:  "mnemonic -> CLFLUSH",
    4:  "mnemonic -> CLFLUSHOPT",
    5:  "mnemonic -> CLWB",
    6:  "mnemonic -> PREFETCHT0",
    7:  "mnemonic -> PREFETCHT1",
    8:  "mnemonic -> PREFETCHT2",
    9:  "mnemonic -> PREFETCHNTA",
    10: "mnemonic -> WBINVD",
    11: "mnemonic -> INVD",
    12: "operand -> memory_address",
    13: "memory_address -> [ base_expr ]",
    14: "base_expr -> REGISTER offset",
    15: "base_expr -> REGISTER",
    16: "base_expr -> IDENTIFIER",
    17: "offset -> + NUMBER",
    18: "offset -> - NUMBER"
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªØ¹Ø±ÛŒÙ Ù†Ù…Ø§Ø¯Ù‡Ø§ (Symbols)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TERMINALS = [
    'CLFLUSH', 'CLFLUSHOPT', 'CLWB',
    'PREFETCHT0', 'PREFETCHT1', 'PREFETCHT2', 'PREFETCHNTA',
    'WBINVD', 'INVD',
    '[', ']', 'REGISTER', 'IDENTIFIER', '+', '-', 'NUMBER', '$'
]

NON_TERMINALS = ['instruction', 'mnemonic', 'operand', 'memory_address', 'base_expr', 'offset']

# Ú¯Ø±ÙˆÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¯Ø³ØªÙˆØ±Ø§Øª
FLUSH_OPS = ['CLFLUSH', 'CLFLUSHOPT']
WRITEBACK_OPS = ['CLWB']
PREFETCH_OPS = ['PREFETCHT0', 'PREFETCHT1', 'PREFETCHT2', 'PREFETCHNTA']
INVALIDATE_OPS = ['WBINVD', 'INVD']

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø¬Ø¯ÙˆÙ„ Ù¾Ø§Ø±Ø³ Ú©Ø§Ù…Ù„ LR(0)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ÙØ±Ù…Øª: {state: {symbol: action}}
# action = 'sN' (shift to N), 'rN' (reduce by rule N), 'acc' (accept), 'N' (goto N)

LR_PARSING_TABLE = {
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 0: Initial state
    # Items: S' -> . instruction
    #        instruction -> . mnemonic operand
    #        instruction -> . mnemonic
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    0: {
        'CLFLUSH':     's3',
        'CLFLUSHOPT':  's3',
        'CLWB':        's3',
        'PREFETCHT0':  's3',
        'PREFETCHT1':  's3',
        'PREFETCHT2':  's3',
        'PREFETCHNTA': 's3',
        'WBINVD':      's4',
        'INVD':        's4',
        'instruction': '1',   # goto
        'mnemonic':    '2'    # goto
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 1: Accept state
    # Items: S' -> instruction .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    1: {
        '$': 'acc'
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 2: After mnemonic
    # Items: instruction -> mnemonic . operand
    #        instruction -> mnemonic .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    2: {
        '[':      's6',
        '$':      'r2',      # reduce: instruction -> mnemonic
        'operand': '5'       # goto
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 3: After CLFLUSH/CLFLUSHOPT/CLWB/PREFETCH
    # Items: mnemonic -> CLFLUSH/CLFLUSHOPT/... .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    3: {
        '[': 'r3',   # reduce by rules 3-9 depending on token
        '$': 'r3'    # (simplified - parser determines actual rule)
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 4: After WBINVD/INVD
    # Items: mnemonic -> WBINVD/INVD .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    4: {
        '[': 'r10',  # reduce by rules 10-11 depending on token
        '$': 'r10'
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 5: After operand
    # Items: instruction -> mnemonic operand .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    5: {
        '$': 'r1'    # reduce: instruction -> mnemonic operand
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 6: After '['
    # Items: memory_address -> [ . base_expr ]
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    6: {
        'REGISTER':   's8',
        'IDENTIFIER': 's9',
        'base_expr':  '7'    # goto
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 7: After base_expr
    # Items: memory_address -> [ base_expr . ]
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    7: {
        ']': 's10'
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 8: After REGISTER
    # Items: base_expr -> REGISTER . offset
    #        base_expr -> REGISTER .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    8: {
        '+':     's12',
        '-':     's12',
        ']':     'r15',   # reduce: base_expr -> REGISTER
        'offset': '11'    # goto
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 9: After IDENTIFIER
    # Items: base_expr -> IDENTIFIER .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    9: {
        ']': 'r16'   # reduce: base_expr -> IDENTIFIER
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 10: After ']'
    # Items: memory_address -> [ base_expr ] .
    #        operand -> memory_address .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    10: {
        '$': 'r13'   # reduce: memory_address -> [ base_expr ]
                     # followed by r12: operand -> memory_address
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 11: After offset
    # Items: base_expr -> REGISTER offset .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    11: {
        ']': 'r14'   # reduce: base_expr -> REGISTER offset
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 12: After '+' or '-'
    # Items: offset -> + . NUMBER
    #        offset -> - . NUMBER
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    12: {
        'NUMBER': 's13'
    },

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # State 13: After NUMBER
    # Items: offset -> + NUMBER .
    #        offset -> - NUMBER .
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    13: {
        ']': 'r17'   # reduce by rules 17-18 depending on sign
    }
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ (Helper Functions)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def get_action(state, terminal):
    """
    Ø¯Ø±ÛŒØ§ÙØª action Ø¨Ø±Ø§ÛŒ ÛŒÚ© state Ùˆ terminal

    Returns:
        str: action ('sN', 'rN', 'acc', or None for error)
    """
    if state in LR_PARSING_TABLE:
        return LR_PARSING_TABLE[state].get(terminal)
    return None

def get_goto(state, non_terminal):
    """
    Ø¯Ø±ÛŒØ§ÙØª goto Ø¨Ø±Ø§ÛŒ ÛŒÚ© state Ùˆ non-terminal

    Returns:
        str: state number or None
    """
    if state in LR_PARSING_TABLE:
        return LR_PARSING_TABLE[state].get(non_terminal)
    return None

def print_grammar_rules():
    """Ú†Ø§Ù¾ Ù‚ÙˆØ§Ù†ÛŒÙ† Ú¯Ø±Ø§Ù…Ø±"""
    print("\n" + "â•" * 80)
    print(" " * 25 + "Ù‚ÙˆØ§Ù†ÛŒÙ† Ú¯Ø±Ø§Ù…Ø± (Grammar Rules)")
    print("â•" * 80 + "\n")

    for rule_num, rule in GRAMMAR_RULES.items():
        print(f"R{rule_num:2d}: {rule}")
    print()

def print_parsing_table():
    """Ú†Ø§Ù¾ Ø¬Ø¯ÙˆÙ„ Ù¾Ø§Ø±Ø³ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ§Ù†Ø§"""
    print("\n" + "â•" * 100)
    print(" " * 35 + "Ø¬Ø¯ÙˆÙ„ Ù¾Ø§Ø±Ø³ LR(0)")
    print("â•" * 100 + "\n")

    # Ù‡Ø¯Ø± Ø¬Ø¯ÙˆÙ„
    print(f"{'State':<7} â”‚ {'ACTION':<65} â”‚ {'GOTO':<22}")
    print("â”€" * 100)

    for state in sorted(LR_PARSING_TABLE.keys()):
        actions = []
        gotos = []

        for symbol, action in LR_PARSING_TABLE[state].items():
            if symbol in TERMINALS:
                actions.append(f"{symbol}:{action}")
            elif symbol in NON_TERMINALS:
                gotos.append(f"{symbol}:{action}")

        action_str = ", ".join(actions) if actions else "â€”"
        goto_str = ", ".join(gotos) if gotos else "â€”"

        # Truncate if too long
        if len(action_str) > 63:
            action_str = action_str[:60] + "..."
        if len(goto_str) > 20:
            goto_str = goto_str[:17] + "..."

        print(f"{state:<7} â”‚ {action_str:<65} â”‚ {goto_str:<22}")

    print("â”€" * 100)
    print("\nğŸ“ Ø±Ø§Ù‡Ù†Ù…Ø§:")
    print("  â€¢ sN  = Shift to state N")
    print("  â€¢ rN  = Reduce by rule N")
    print("  â€¢ acc = Accept")
    print("  â€¢ N   = Goto state N (for non-terminals)")
    print()

def print_matrix_table():
    """Ú†Ø§Ù¾ Ø¬Ø¯ÙˆÙ„ Ø¨Ù‡ ØµÙˆØ±Øª Ù…Ø§ØªØ±ÛŒØ³ÛŒ Ú©Ø§Ù…Ù„"""
    try:
        import pandas as pd

        print("\n" + "â•" * 120)
        print(" " * 40 + "Ø¬Ø¯ÙˆÙ„ Ù¾Ø§Ø±Ø³ Ú©Ø§Ù…Ù„ (ÙØ±Ù…Øª Ù…Ø§ØªØ±ÛŒØ³ÛŒ)")
        print("â•" * 120 + "\n")

        # Ø³Ø§Ø®Øª Ù…Ø§ØªØ±ÛŒØ³
        action_terms = ['CLFLUSH', 'CLFLUSHOPT', 'CLWB', 'PREFETCH*', 
                        'WBINVD', 'INVD', '[', ']', 'REG', 'ID', '+', '-', 'NUM', '$']
        goto_nonterms = ['inst', 'mnem', 'op', 'mem', 'base', 'off']

        data = []
        for state in range(14):
            row = {'State': state}

            # Simplified mapping
            state_data = LR_PARSING_TABLE.get(state, {})

            for term in action_terms:
                if term == 'PREFETCH*':
                    val = state_data.get('PREFETCHT0', '')
                elif term == 'REG':
                    val = state_data.get('REGISTER', '')
                elif term == 'ID':
                    val = state_data.get('IDENTIFIER', '')
                elif term == 'NUM':
                    val = state_data.get('NUMBER', '')
                else:
                    val = state_data.get(term, '')
                row[term] = val

            # Goto columns (simplified names)
            mapping = {
                'inst': 'instruction',
                'mnem': 'mnemonic',
                'op': 'operand',
                'mem': 'memory_address',
                'base': 'base_expr',
                'off': 'offset'
            }

            for short, full in mapping.items():
                row[short] = state_data.get(full, '')

            data.append(row)

        df = pd.DataFrame(data)

        print("Ø¨Ø®Ø´ 1: ACTION (ØªØ±Ù…ÛŒÙ†Ø§Ù„â€ŒÙ‡Ø§)")
        print("â”€" * 100)
        action_cols = ['State'] + action_terms
        print(df[action_cols].to_string(index=False))

        print("\n\nØ¨Ø®Ø´ 2: GOTO (Ù†Ø§Ù†â€ŒØªØ±Ù…ÛŒÙ†Ø§Ù„â€ŒÙ‡Ø§)")
        print("â”€" * 60)
        goto_cols = ['State'] + goto_nonterms
        print(df[goto_cols].to_string(index=False))
        print("\n" + "â”€" * 100 + "\n")

    except ImportError:
        print("âš ï¸ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù…Ø§ØªØ±ÛŒØ³ÛŒØŒ Ù¾Ú©ÛŒØ¬ pandas Ù†ÛŒØ§Ø² Ø§Ø³Øª: pip install pandas")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Main
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if __name__ == "__main__":
    print("â•”" + "â•" * 80 + "â•—")
    print("â•‘" + " " * 20 + "Ø¬Ø¯ÙˆÙ„ Ù¾Ø§Ø±Ø³ Ú©Ø§Ù…Ù„ LR(0) - Ú¯Ø±ÙˆÙ‡ 15" + " " * 28 + "â•‘")
    print("â•š" + "â•" * 80 + "â•")

    # 1. Ú†Ø§Ù¾ Ù‚ÙˆØ§Ù†ÛŒÙ† Ú¯Ø±Ø§Ù…Ø±
    print_grammar_rules()

    # 2. Ú†Ø§Ù¾ Ø¬Ø¯ÙˆÙ„ Ø¨Ù‡ ÙØ±Ù…Øª Ø³Ø§Ø¯Ù‡
    print_parsing_table()

    # 3. Ú†Ø§Ù¾ Ø¬Ø¯ÙˆÙ„ Ø¨Ù‡ ÙØ±Ù…Øª Ù…Ø§ØªØ±ÛŒØ³ÛŒ (Ø§Ú¯Ø± pandas Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ø¯)
    print_matrix_table()

    print("\nâœ… Ø¬Ø¯ÙˆÙ„ Ù¾Ø§Ø±Ø³ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯!")
    print("ğŸ“„ Ø§ÛŒÙ† Ø¬Ø¯ÙˆÙ„ Ø´Ø§Ù…Ù„ ØªÙ…Ø§Ù… states Ùˆ transitions Ø§Ø³Øª.")
